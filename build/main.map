{"version":3,"sources":["webpack:///webpack/bootstrap 2c5e7ea93a11f60e8324","webpack:///external \"sequelize\"","webpack:///external \"feathers-authentication\"","webpack:///external \"feathers-sequelize\"","webpack:///external \"winston\"","webpack:///external \"path\"","webpack:///external \"feathers-hooks-common\"","webpack:///external \"feathers-authentication-local\"","webpack:///external \"feathers-authentication-management\"","webpack:///./src/notifier.js","webpack:///./src/index.js","webpack:///./src/app.js","webpack:///external \"serve-favicon\"","webpack:///external \"compression\"","webpack:///external \"cors\"","webpack:///external \"helmet\"","webpack:///external \"body-parser\"","webpack:///external \"feathers\"","webpack:///external \"feathers-configuration\"","webpack:///external \"feathers-hooks\"","webpack:///external \"feathers-rest\"","webpack:///external \"feathers-socketio\"","webpack:///external \"feathers-errors/handler\"","webpack:///external \"feathers-errors/not-found\"","webpack:///./src/middleware/index.js","webpack:///./src/services/index.js","webpack:///./src/services/users/users.service.js","webpack:///./src/models/users.model.js","webpack:///./src/services/users/users.hooks.js","webpack:///external \"feathers-authentication-hooks\"","webpack:///./src/hooks/send-verification-email.js","webpack:///external \"pug\"","webpack:///./src/hooks/user-client.js","webpack:///./src/hooks/user-client-after.js","webpack:///./src/hooks/users-restrict.js","webpack:///external \"feathers-errors\"","webpack:///./src/services/users/users.filters.js","webpack:///./src/services/roles/roles.service.js","webpack:///./src/models/roles.model.js","webpack:///./src/services/roles/roles.hooks.js","webpack:///./src/services/roles/roles.filters.js","webpack:///./src/services/email/email.service.js","webpack:///external \"feathers-mailer\"","webpack:///./src/services/email/email.hooks.js","webpack:///external \"nodemailer-smtp-transport\"","webpack:///./src/services/clients/clients.service.js","webpack:///./src/models/clients.model.js","webpack:///./src/services/clients/clients.hooks.js","webpack:///./src/services/clients/clients.filters.js","webpack:///./src/app.hooks.js","webpack:///./src/hooks/logger.js","webpack:///./src/authentication.js","webpack:///external \"feathers-authentication-jwt\"","webpack:///./src/sequelize.js","webpack:///./src/seed/index.js","webpack:///./src/seed/roles.js","webpack:///./src/seed/users.js","webpack:///./src/seed/clients.js"],"names":["path","require","pug","isProd","returnEmail","module","exports","app","getLink","type","hash","port","host","protocal","sendEmail","email","service","create","then","result","console","log","catch","err","notifier","user","notifierOptions","hashLink","emailAccountTemplatesPath","join","__dirname","templatePath","compiledHTML","verifyToken","renderFile","logo","name","from","to","subject","html","resetToken","logger","get","server","listen","process","on","reason","p","error","info","favicon","compress","cors","helmet","bodyParser","feathers","configuration","hooks","rest","socketio","handler","notFound","middleware","services","appHooks","authentication","sequelize","configure","use","json","urlencoded","extended","static","users","roles","clients","createService","createModel","filters","Model","paginate","options","filter","Sequelize","DataTypes","sequelizeClient","define","id","UUID","primaryKey","defaultValue","UUIDV4","STRING","allowNull","unique","password","isEnabled","BOOLEAN","role","isVerified","verifyShortToken","verifyExpires","DATE","verifyChanges","JSONB","resetShortToken","resetExpires","beforeCount","raw","associate","models","belongsTo","authenticate","commonHooks","restrictToOwner","hashPassword","verifyHooks","restrict","idField","ownerField","sendVerificationEmail","userClient","userClientAfter","usersRestrict","before","all","find","addVerification","update","disallow","patch","iff","isProvider","preventChanges","remove","after","when","hook","params","provider","discard","removeVerification","accountService","Promise","resolve","include","model","query","data","errors","NotAuthenticated","NotAcceptable","length","clientId","Forbidden","NotFound","warn","connection","Mailer","smtpTransport","message","method","debug","jwt","local","authManagement","config","strategies","seed","connectionString","dialect","logging","freezeTableName","oldSetup","setup","set","args","apply","Object","keys","forEach","sync","rolesData","usersData","clientsData","ifEmptyCreate2","ifEmptyCreate","bind","found","Number","isInteger","total","Array","isArray","system","admin","basic","env","PASSWORD","cvrno","map","client"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 9);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2c5e7ea93a11f60e8324","module.exports = require(\"sequelize\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sequelize\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"feathers-authentication\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"feathers-authentication\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"feathers-sequelize\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"feathers-sequelize\"\n// module id = 2\n// module chunks = 0","module.exports = require(\"winston\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"winston\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"feathers-hooks-common\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"feathers-hooks-common\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"feathers-authentication-local\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"feathers-authentication-local\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"feathers-authentication-management\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"feathers-authentication-management\"\n// module id = 7\n// module chunks = 0","const path = require('path')\nconst pug = require('pug')\nconst isProd = process.env.NODE_ENV === 'production'\nconst returnEmail = 'noreply@le34.dk'\nmodule.exports = function (app) {\n  function getLink (type, hash) {\n    var port = ':3000'\n    var host = 'localhost'\n    var protocal = isProd ? 'https' : 'http'\n    protocal += '://'\n    return `${protocal}${host}${port}/${type}/${hash}`\n  }\n  function sendEmail (email) {\n    return app.service('email').create(email).then(function (result) {\n      console.log('Sent email', result)\n    }).catch(err => {\n      console.log('Error sending email', err)\n    })\n  }\n  return {\n    notifier: function (type, user, notifierOptions) {\n      console.log(`-- Preparing email for ${type}`)\n      var hashLink\n      var email\n      var emailAccountTemplatesPath = path.join(__dirname, 'email-templates')\n      console.log('emailAccountTemplatesPath', emailAccountTemplatesPath)\n      var templatePath\n      var compiledHTML\n\n      switch (type) {\n        case 'resendVerifySignup': // send another email with link for verifying user's email addr\n\n          hashLink = getLink('verify', user.verifyToken)\n          console.log(hashLink)\n          templatePath = path.join(emailAccountTemplatesPath, 'verify-email.pug')\n\n          compiledHTML = pug.renderFile(templatePath, {\n            logo: '',\n            name: user.name || user.email,\n            hashLink,\n            returnEmail\n          })\n\n          email = {\n            from: returnEmail,\n            to: user.email,\n            subject: 'Confirm Signup',\n            html: compiledHTML\n          }\n\n          return sendEmail(email)\n        case 'sendResetPwd': // inform that user's email is now confirmed\n\n          hashLink = getLink('reset', user.resetToken)\n\n          templatePath = path.join(emailAccountTemplatesPath, 'reset-password.pug')\n\n          compiledHTML = pug.renderFile(templatePath, {\n            logo: '',\n            name: user.name || user.email,\n            hashLink,\n            returnEmail\n          })\n\n          email = {\n            from: returnEmail,\n            to: user.email,\n            subject: 'Reset Password',\n            html: compiledHTML\n          }\n\n          return sendEmail(email)\n        case 'resetPwd': // inform that user's email is now confirmed\n\n          hashLink = getLink('reset', user.resetToken)\n\n          templatePath = path.join(emailAccountTemplatesPath, 'password-was-reset.pug')\n\n          compiledHTML = pug.renderFile(templatePath, {\n            logo: '',\n            name: user.name || user.email,\n            hashLink,\n            returnEmail\n          })\n\n          email = {\n            from: returnEmail,\n            to: user.email,\n            subject: 'Your password was reset',\n            html: compiledHTML\n          }\n\n          return sendEmail(email)\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/notifier.js","/* eslint-disable no-console */\nconst logger = require('winston')\nconst app = require('./app')\nconst port = app.get('port')\nconst server = app.listen(port)\n\nprocess.on('unhandledRejection', (reason, p) =>\n  logger.error('Unhandled Rejection at: Promise ', p, reason)\n)\n\nserver.on('listening', () =>\n  logger.info('Feathers application started on http://%s:%d', app.get('host'), port)\n)\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","const path = require('path')\nconst favicon = require('serve-favicon')\nconst compress = require('compression')\nconst cors = require('cors')\nconst helmet = require('helmet')\nconst bodyParser = require('body-parser')\n\nconst feathers = require('feathers')\nconst configuration = require('feathers-configuration')\nconst hooks = require('feathers-hooks')\nconst rest = require('feathers-rest')\nconst socketio = require('feathers-socketio')\n\nconst handler = require('feathers-errors/handler')\nconst notFound = require('feathers-errors/not-found')\n\nconst middleware = require('./middleware')\nconst services = require('./services')\nconst appHooks = require('./app.hooks')\n\nconst authentication = require('./authentication')\n\nconst sequelize = require('./sequelize')\n\nconst app = feathers()\n\n// Load app configuration\napp.configure(configuration())\n// Enable CORS, security, compression, favicon and body parsing\napp.use(cors())\napp.use(helmet())\napp.use(compress())\napp.use(bodyParser.json())\napp.use(bodyParser.urlencoded({ extended: true }))\napp.use(favicon(path.join(app.get('public'), 'favicon.ico')))\n// Host the public folder\napp.use('/', feathers.static(app.get('public')))\n\n// Set up Plugins and providers\napp.configure(hooks())\napp.configure(sequelize)\napp.configure(rest())\napp.configure(socketio())\n\n// Configure other middleware (see `middleware/index.js`)\napp.configure(middleware)\napp.configure(authentication)\n// Set up our services (see `services/index.js`)\napp.configure(services)\n\n// Configure a middleware for 404s and the error handler\napp.use(notFound())\napp.use(handler())\n\napp.hooks(appHooks)\n\nmodule.exports = app\n\n\n\n// WEBPACK FOOTER //\n// ./src/app.js","module.exports = require(\"serve-favicon\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"serve-favicon\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"compression\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"compression\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cors\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"helmet\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"helmet\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"feathers\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"feathers\"\n// module id = 17\n// module chunks = 0","module.exports = require(\"feathers-configuration\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"feathers-configuration\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"feathers-hooks\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"feathers-hooks\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"feathers-rest\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"feathers-rest\"\n// module id = 20\n// module chunks = 0","module.exports = require(\"feathers-socketio\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"feathers-socketio\"\n// module id = 21\n// module chunks = 0","module.exports = require(\"feathers-errors/handler\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"feathers-errors/handler\"\n// module id = 22\n// module chunks = 0","module.exports = require(\"feathers-errors/not-found\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"feathers-errors/not-found\"\n// module id = 23\n// module chunks = 0","module.exports = function () {\n  // Add your custom middleware here. Remember, that\n  // in Express the order matters\n  const app = this // eslint-disable-line no-unused-vars\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/middleware/index.js","const users = require('./users/users.service.js')\nconst roles = require('./roles/roles.service.js')\nconst email = require('./email/email.service.js')\nconst clients = require('./clients/clients.service.js')\nmodule.exports = function () {\n  const app = this // eslint-disable-line no-unused-vars\n  app.configure(users)\n  app.configure(roles)\n  app.configure(email)\n  app.configure(clients)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/index.js","// Initializes the `users` service on path `/users`\nconst createService = require('feathers-sequelize')\nconst createModel = require('../../models/users.model')\nconst hooks = require('./users.hooks')\nconst filters = require('./users.filters')\n\nmodule.exports = function () {\n  const app = this\n  const Model = createModel(app)\n  const paginate = app.get('paginate')\n\n  const options = {\n    name: 'users',\n    Model,\n    paginate\n  }\n\n  // Initialize our service with any options it requires\n  app.use('/users', createService(options))\n\n  // Get our initialized service so that we can register hooks and filters\n  const service = app.service('users')\n\n  service.hooks(hooks)\n\n  if (service.filter) {\n    service.filter(filters)\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/users/users.service.js","// See http://docs.sequelizejs.com/en/latest/docs/models-definition/\n// for more of what you can do here.\nconst Sequelize = require('sequelize')\nconst DataTypes = Sequelize.DataTypes\n\nmodule.exports = function (app) {\n  const sequelizeClient = app.get('sequelizeClient')\n  const users = sequelizeClient.define('users', {\n    id: {\n      type: DataTypes.UUID,\n      primaryKey: true,\n      defaultValue: DataTypes.UUIDV4\n    },\n    email: {\n      type: DataTypes.STRING,\n      allowNull: false,\n      unique: true\n    },\n    password: {\n      type: DataTypes.STRING,\n      allowNull: false,\n      defaultValue: DataTypes.UUIDV4\n    },\n    isEnabled: {\n      type: DataTypes.BOOLEAN,\n      defaultValue: true\n    },\n    role: {\n      type: DataTypes.STRING,\n      allowNull: false,\n      defaultValue: 'basic'\n    },\n    isVerified: { type: DataTypes.BOOLEAN },\n    verifyToken: { type: DataTypes.STRING },\n    verifyShortToken: { type: DataTypes.STRING },\n    verifyExpires: { type: DataTypes.DATE }, // or a long integer\n    verifyChanges: { type: DataTypes.JSONB }, // an object (key-value map), e.g. { field: \"value\" }\n    resetToken: { type: DataTypes.STRING },\n    resetShortToken: { type: DataTypes.STRING },\n    resetExpires: { type: DataTypes.DATE } // or a long integer\n  }, {\n    hooks: {\n      beforeCount (options) {\n        options.raw = true\n      }\n    }\n  })\n\n  users.associate = function (models) { // eslint-disable-line no-unused-vars\n    // Define associations here\n    // See http://docs.sequelizejs.com/en/latest/docs/associations/\n    models.users.belongsTo(models.clients)\n  }\n\n  return users\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/users.model.js","const { authenticate } = require('feathers-authentication').hooks\nconst commonHooks = require('feathers-hooks-common')\nconst { restrictToOwner } = require('feathers-authentication-hooks')\nconst { hashPassword } = require('feathers-authentication-local').hooks\nconst verifyHooks = require('feathers-authentication-management').hooks\nconst restrict = [\n  authenticate('jwt'),\n  restrictToOwner({\n    idField: 'id',\n    ownerField: 'id'\n  })\n]\n\nconst sendVerificationEmail = require('../../hooks/send-verification-email')\n\nconst userClient = require('../../hooks/user-client')\n\nconst userClientAfter = require('../../hooks/user-client-after')\n\nconst usersRestrict = require('../../hooks/users-restrict')\n\nmodule.exports = {\n  before: {\n    all: [],\n    find: [authenticate('jwt'), userClient()],\n    get: [...restrict],\n    create: [hashPassword(), verifyHooks.addVerification()],\n    update: [commonHooks.disallow('external')],\n    patch: [\n      ...restrict,\n      commonHooks.iff(commonHooks.isProvider('external'), commonHooks.preventChanges(\n        'email',\n        'isVerified',\n        'verifyToken',\n        'verifyShortToken',\n        'verifyExpires',\n        'verifyChanges',\n        'resetToken',\n        'resetShortToken',\n        'resetExpires'\n      ))\n    ],\n    remove: [authenticate('jwt'), usersRestrict()]\n  },\n\n  after: {\n    all: [\n      commonHooks.when(\n        hook => hook.params.provider,\n        commonHooks.discard('password', 'verifyExpires', 'resetExpires', 'verifyChanges')\n      )\n    ],\n    find: [],\n    get: [],\n    create: [\n      sendVerificationEmail(),\n      verifyHooks.removeVerification(),\n      userClientAfter()\n    ],\n    update: [userClientAfter()],\n    patch: [userClientAfter()],\n    remove: []\n  },\n\n  error: {\n    all: [],\n    find: [],\n    get: [],\n    create: [],\n    update: [],\n    patch: [],\n    remove: []\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/users/users.hooks.js","module.exports = require(\"feathers-authentication-hooks\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"feathers-authentication-hooks\"\n// module id = 29\n// module chunks = 0","// Use this hook to manipulate incoming or outgoing data.\n// For more information on hooks see: http://docs.feathersjs.com/api/hooks.html\nconst accountService = require('../notifier')\nmodule.exports = function (options = {}) { // eslint-disable-line no-unused-vars\n  return function sendVerificationEmail (hook) {\n    const user = hook.result\n    if (user) {\n      accountService(hook.app).notifier('resendVerifySignup', user)\n      return Promise.resolve(hook)\n    }\n    // Hooks can either return nothing or a promise\n    // that resolves with the `hook` object for asynchronous operations\n    return Promise.resolve(hook)\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/hooks/send-verification-email.js","module.exports = require(\"pug\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"pug\"\n// module id = 31\n// module chunks = 0","// Use this hook to manipulate incoming or outgoing data.\n// For more information on hooks see: http://docs.feathersjs.com/api/hooks.html\n\nmodule.exports = function (options = {}) { // eslint-disable-line no-unused-vars\n  return function userClient (hook) {\n    hook.params.sequelize = {\n      include: [{ model: hook.app.services.clients.Model }]\n    }\n    return Promise.resolve(hook)\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/hooks/user-client.js","// Use this hook to manipulate incoming or outgoing data.\n// For more information on hooks see: http://docs.feathersjs.com/api/hooks.html\n\nmodule.exports = function (options = {}) { // eslint-disable-line no-unused-vars\n  return function userClientAfter (hook) {\n    return hook.app.service('/users').find({ query: { id: hook.result.id } }).then(result => {\n      hook.result = result.data[0]\n      return Promise.resolve(hook)\n    })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/hooks/user-client-after.js","// Use this hook to manipulate incoming or outgoing data.\n// For more information on hooks see: http://docs.feathersjs.com/api/hooks.html\nconst errors = require('feathers-errors')\nmodule.exports = function (options = {}) { // eslint-disable-line no-unused-vars\n  return function usersRestrict (hook) {\n    if (!hook.params.user) {\n      throw new errors.NotAuthenticated()\n    }\n    if (hook.params.user.id === hook.id) {\n      throw new errors.NotAcceptable('Du må ikke slette dig selv')\n    }\n    if (hook.params.user.role === 'system') {\n      return Promise.resolve(hook)\n    }\n    return hook.app.service('/users').find({ query: { id: hook.id } }).then(result => {\n      if (result.data.length === 1) {\n        const user = result.data[0]\n        if (hook.params.user.role === 'admin' && hook.params.user.clientId === user.clientId) {\n          return Promise.resolve(hook)\n        }\n        throw new errors.Forbidden('Du har ikke rettigheder til denne handling')\n      }\n      throw new errors.NotFound()\n    })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/hooks/users-restrict.js","module.exports = require(\"feathers-errors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"feathers-errors\"\n// module id = 35\n// module chunks = 0","/* eslint no-console: 1 */\nconsole.warn('You are using the default filter for the users service. For more information about event filters see https://docs.feathersjs.com/api/events.html#event-filtering') // eslint-disable-line no-console\n\nmodule.exports = function (data, connection, hook) { // eslint-disable-line no-unused-vars\n  return data\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/users/users.filters.js","// Initializes the `roles` service on path `/roles`\nconst createService = require('feathers-sequelize')\nconst createModel = require('../../models/roles.model')\nconst hooks = require('./roles.hooks')\nconst filters = require('./roles.filters')\n\nmodule.exports = function () {\n  const app = this\n  const Model = createModel(app)\n  const paginate = app.get('paginate')\n\n  const options = {\n    name: 'roles',\n    Model,\n    paginate\n  }\n\n  // Initialize our service with any options it requires\n  app.use('/roles', createService(options))\n\n  // Get our initialized service so that we can register hooks and filters\n  const service = app.service('roles')\n\n  service.hooks(hooks)\n\n  if (service.filter) {\n    service.filter(filters)\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/roles/roles.service.js","// See http://docs.sequelizejs.com/en/latest/docs/models-definition/\n// for more of what you can do here.\nconst Sequelize = require('sequelize')\nconst DataTypes = Sequelize.DataTypes\n\nmodule.exports = function (app) {\n  const sequelizeClient = app.get('sequelizeClient')\n  const roles = sequelizeClient.define('roles', {\n    id: {\n      type: DataTypes.UUID,\n      primaryKey: true,\n      defaultValue: DataTypes.UUIDV4\n    },\n    role: {\n      type: DataTypes.STRING,\n      allowNull: false,\n      unique: true\n    }\n  },\n  {\n    hooks: {\n      beforeCount (options) {\n        options.raw = true\n      }\n    }\n  })\n\n  roles.associate = function (models) { // eslint-disable-line no-unused-vars\n    // Define associations here\n    // See http://docs.sequelizejs.com/en/latest/docs/associations/\n  }\n\n  return roles\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/roles.model.js","const { authenticate } = require('feathers-authentication').hooks\n\nmodule.exports = {\n  before: {\n    all: [ authenticate('jwt') ],\n    find: [],\n    get: [],\n    create: [],\n    update: [],\n    patch: [],\n    remove: []\n  },\n\n  after: {\n    all: [],\n    find: [],\n    get: [],\n    create: [],\n    update: [],\n    patch: [],\n    remove: []\n  },\n\n  error: {\n    all: [],\n    find: [],\n    get: [],\n    create: [],\n    update: [],\n    patch: [],\n    remove: []\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/roles/roles.hooks.js","/* eslint no-console: 1 */\nconsole.warn('You are using the default filter for the roles service. For more information about event filters see https://docs.feathersjs.com/api/events.html#event-filtering') // eslint-disable-line no-console\n\nmodule.exports = function (data, connection, hook) { // eslint-disable-line no-unused-vars\n  return data\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/roles/roles.filters.js","// Initializes the `email` service on path `/email`\nconst Mailer = require('feathers-mailer')\nconst hooks = require('./email.hooks')\nconst smtpTransport = require('nodemailer-smtp-transport')\n\nmodule.exports = function () {\n  const app = this\n\n  // Initialize our service with any options it requires\n  app.use('/email', Mailer(smtpTransport({\n    host: 'mail.le34.dk',\n    port: 26 // 25 DMZ\n  })))\n  // Get our initialized service so that we can register hooks and filters\n  const service = app.service('email')\n\n  service.hooks(hooks)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/email/email.service.js","module.exports = require(\"feathers-mailer\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"feathers-mailer\"\n// module id = 42\n// module chunks = 0","const { disallow } = require('feathers-hooks-common')\n\nmodule.exports = {\n  before: {\n    all: [disallow('external')],\n    find: [],\n    get: [],\n    create: [],\n    update: [],\n    patch: [],\n    remove: []\n  },\n\n  after: {\n    all: [],\n    find: [],\n    get: [],\n    create: [],\n    update: [],\n    patch: [],\n    remove: []\n  },\n\n  error: {\n    all: [],\n    find: [],\n    get: [],\n    create: [],\n    update: [],\n    patch: [],\n    remove: []\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/email/email.hooks.js","module.exports = require(\"nodemailer-smtp-transport\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nodemailer-smtp-transport\"\n// module id = 44\n// module chunks = 0","// Initializes the `clients` service on path `/clients`\nconst createService = require('feathers-sequelize')\nconst createModel = require('../../models/clients.model')\nconst hooks = require('./clients.hooks')\nconst filters = require('./clients.filters')\n\nmodule.exports = function () {\n  const app = this\n  const Model = createModel(app)\n  const paginate = app.get('paginate')\n\n  const options = {\n    name: 'clients',\n    Model,\n    paginate\n  }\n\n  // Initialize our service with any options it requires\n  app.use('/clients', createService(options))\n\n  // Get our initialized service so that we can register hooks and filters\n  const service = app.service('clients')\n\n  service.hooks(hooks)\n\n  if (service.filter) {\n    service.filter(filters)\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/clients/clients.service.js","// See http://docs.sequelizejs.com/en/latest/docs/models-definition/\n// for more of what you can do here.\nconst Sequelize = require('sequelize')\nconst DataTypes = Sequelize.DataTypes\n\nmodule.exports = function (app) {\n  const sequelizeClient = app.get('sequelizeClient')\n  const clients = sequelizeClient.define('clients', {\n    id: {\n      type: DataTypes.UUID,\n      primaryKey: true,\n      defaultValue: DataTypes.UUIDV4\n    },\n    data: {\n      type: DataTypes.JSONB,\n      allowNull: false\n    }\n  }, {\n    hooks: {\n      beforeCount (options) {\n        options.raw = true\n      }\n    }\n  })\n\n  clients.associate = function (models) { // eslint-disable-line no-unused-vars\n    // Define associations here\n    // See http://docs.sequelizejs.com/en/latest/docs/associations/\n  }\n\n  return clients\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/clients.model.js","const { authenticate } = require('feathers-authentication').hooks\n\nmodule.exports = {\n  before: {\n    all: [ authenticate('jwt') ],\n    find: [],\n    get: [],\n    create: [],\n    update: [],\n    patch: [],\n    remove: []\n  },\n\n  after: {\n    all: [],\n    find: [],\n    get: [],\n    create: [],\n    update: [],\n    patch: [],\n    remove: []\n  },\n\n  error: {\n    all: [],\n    find: [],\n    get: [],\n    create: [],\n    update: [],\n    patch: [],\n    remove: []\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/clients/clients.hooks.js","/* eslint no-console: 1 */\nconsole.warn('You are using the default filter for the clients service. For more information about event filters see https://docs.feathersjs.com/api/events.html#event-filtering') // eslint-disable-line no-console\n\nmodule.exports = function (data, connection, hook) { // eslint-disable-line no-unused-vars\n  return data\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/clients/clients.filters.js","// Application hooks that run for every service\nconst logger = require('./hooks/logger')\n\nmodule.exports = {\n  before: {\n    all: [],\n    find: [],\n    get: [],\n    create: [],\n    update: [],\n    patch: [],\n    remove: []\n  },\n\n  after: {\n    all: [ logger() ],\n    find: [],\n    get: [],\n    create: [],\n    update: [],\n    patch: [],\n    remove: []\n  },\n\n  error: {\n    all: [ logger() ],\n    find: [],\n    get: [],\n    create: [],\n    update: [],\n    patch: [],\n    remove: []\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app.hooks.js","// A hook that logs service method before, after and error\nconst logger = require('winston')\n\nmodule.exports = function () {\n  return function (hook) {\n    let message = `${hook.type}: ${hook.path} - Method: ${hook.method}`\n\n    if (hook.type === 'error') {\n      message += `: ${hook.error.message}`\n    }\n\n    logger.info(message)\n    logger.debug('hook.data', hook.data)\n    logger.debug('hook.params', hook.params)\n\n    if (hook.result) {\n      logger.debug('hook.result', hook.result)\n    }\n\n    if (hook.error) {\n      logger.error(hook.error)\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/hooks/logger.js","const authentication = require('feathers-authentication')\nconst jwt = require('feathers-authentication-jwt')\nconst local = require('feathers-authentication-local')\nconst authManagement = require('feathers-authentication-management')\nconst notifier = require('./notifier')\n\nmodule.exports = function () {\n  const app = this\n  const config = app.get('authentication')\n\n  // Set up authentication with the secret\n  app.configure(authentication(config))\n  app.configure(jwt())\n  app.configure(local())\n  app.configure(authManagement(notifier(app)))\n  // The `authentication` service is used to create a JWT.\n  // The before `create` hook registers strategies that can be used\n  // to create a new valid JWT (e.g. local or oauth2)\n  app.service('authentication').hooks({\n    before: {\n      create: [\n        authentication.hooks.authenticate(config.strategies)\n      ],\n      remove: [\n        authentication.hooks.authenticate('jwt')\n      ]\n    }\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/authentication.js","module.exports = require(\"feathers-authentication-jwt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"feathers-authentication-jwt\"\n// module id = 52\n// module chunks = 0","const Sequelize = require('sequelize')\nconst seed = require('./seed')\nmodule.exports = function () {\n  const app = this\n  const connectionString = app.get('postgres')\n  const sequelize = new Sequelize(connectionString, {\n    dialect: 'postgres',\n    logging: false,\n    define: {\n      freezeTableName: true\n    }\n  })\n  const oldSetup = app.setup\n\n  app.set('sequelizeClient', sequelize)\n\n  app.setup = function (...args) {\n    const result = oldSetup.apply(this, args)\n\n    // Set up data relationships\n    const models = sequelize.models\n    Object.keys(models).forEach(name => {\n      if ('associate' in models[name]) {\n        models[name].associate(models)\n      }\n    })\n\n    // Sync to the database\n    sequelize.sync().then(() => {\n      app.configure(seed)\n    })\n\n    return result\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/sequelize.js","const rolesData = require('./roles.js')\nconst usersData = require('./users.js')\nconst clientsData = require('./clients.js')\n\nmodule.exports = function () {\n  const app = this\n  const ifEmptyCreate2 = ifEmptyCreate.bind(this)\n  app.configure(ifEmptyCreate2('roles', rolesData))\n  app.configure(ifEmptyCreate2('users', usersData))\n  app.configure(ifEmptyCreate2('clients', clientsData))\n}\n\n// ### ifEmptyCreate(model, data)\n/**\n * If the model is empty then populate it's data\n * @param {object} model Mongoose Model\n * @param {object|object[]} data Object data or Array of Object data to insert\n * @return {function} Returns a method to be called by configure\n */\nfunction ifEmptyCreate (name, data) {\n  return async () => {\n    try {\n      let found = await this.service(name).find({query: {}})\n      if (found && Number.isInteger(found.total) && Array.isArray(found.data)) {\n        found = found.data\n      }\n      if (found.length !== 0) { return false }\n      await this.service(name).create(data)\n      console.log('default ' + name + ' created')\n    } catch (err) {\n      if (err) { console.log('trouble seeding ' + name + ': ', err) }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/seed/index.js","const system = {\n  role: 'system'\n}\n\nconst admin = {\n  role: 'admin'\n}\n\nconst basic = {\n  role: 'basic'\n}\n\nmodule.exports = [system, admin, basic]\n\n\n\n// WEBPACK FOOTER //\n// ./src/seed/roles.js","const system = {\n  role: 'system',\n  email: 'rut@le34.dk',\n  password: process.env.PASSWORD || 'admin',\n  isVerified: true,\n  clientId: '6714a515-bec0-4d2b-a5e4-76d16cb845c0'\n}\n\nmodule.exports = [ system ]\n\n\n\n// WEBPACK FOOTER //\n// ./src/seed/users.js","const clients = [\n  {\n    id: '5b9462c3-bd11-4bd0-8937-7db762fb22c0',\n    name: 'Wicotec Kirkebjerg A/S',\n    cvrno: '73585511',\n    type: 'opdragsgiver',\n    clients: ['edaf7d39-985a-4396-85ff-d5a5d4450a16', 'b927d198-351f-4c5d-9054-424bf6fb7c94']\n  },\n  {\n    id: '6714a515-bec0-4d2b-a5e4-76d16cb845c0',\n    name: 'LE34',\n    cvrno: '27758592',\n    type: 'opdragsgiver',\n    clients: ['0b67b5af-ed80-4860-9c49-864060d8ae25', 'b927d198-351f-4c5d-9054-424bf6fb7c94']\n  },\n  {\n    id: '1ec75ea6-7022-4813-9e2d-2630003ea392',\n    name: 'JFE A/S',\n    cvrno: '74760716',\n    type: 'opdragsgiver',\n    clients: ['b428964d-13b3-4aea-91ad-4e32f3481959', '7282afcb-b458-4c6b-b57b-a5cb9e5a6a68', 'bd52f4a5-2cfe-4aff-a0dc-cca6e50f463b']\n  },\n  {\n    id: 'edaf7d39-985a-4396-85ff-d5a5d4450a16',\n    name: 'Albertslund Varmeværk',\n    cvrno: '1003267160',\n    type: 'slutbruger'\n  },\n  {\n    id: 'b927d198-351f-4c5d-9054-424bf6fb7c94',\n    name: 'Hvalsø Kraftvarmeværk',\n    cvrno: '44057212',\n    type: 'slutbruger'\n  },\n  {\n    id: '0b67b5af-ed80-4860-9c49-864060d8ae25',\n    name: 'Egedal Fjernvarme',\n    cvrno: '35410538',\n    type: 'slutbruger'\n  },\n  {\n    id: '1d95ef7d-e51a-42f4-82fa-91b277f4c148',\n    name: 'EnergiMidt',\n    cvrno: '36423544',\n    type: 'slutbruger'\n  },\n  {\n    id: 'b428964d-13b3-4aea-91ad-4e32f3481959',\n    name: 'Solrød Fjernvarme amba',\n    cvrno: '23104113',\n    type: 'slutbruger'\n  },\n  {\n    id: '7282afcb-b458-4c6b-b57b-a5cb9e5a6a68',\n    name: 'Rødovre Kommunale Fjernvarmeforsyning',\n    cvrno: '6530731677',\n    type: 'slutbruger'\n  },\n  {\n    id: 'bd52f4a5-2cfe-4aff-a0dc-cca6e50f463b',\n    name: 'Norfors I/S',\n    cvrno: '14748539',\n    type: 'slutbruger'\n  },\n  {\n    id: '7c830e38-9903-44e6-98f7-7f79941b16ff',\n    name: 'DONG',\n    cvrno: '1234',\n    type: 'slutbruger'\n  },\n  {\n    id: 'c06ea06e-25b5-473e-80ec-abd894a27ddc',\n    name: 'KE_Transmission',\n    cvrno: '',\n    type: 'opdragsgiver',\n    clients: ['7c830e38-9903-44e6-98f7-7f79941b16ff']\n  },\n  {\n    id: 'f4e2bbf9-55b7-4e59-9ff0-2155544fc1fe',\n    name: 'Kemp_Lauritzen',\n    cvrno: '',\n    type: 'opdragsgiver',\n    clients: ['7c830e38-9903-44e6-98f7-7f79941b16ff']\n  },\n  {\n    id: 'aa160aff-b9be-4cdc-8590-fd203644c5e7',\n    name: 'NCC',\n    cvrno: '',\n    type: 'opdragsgiver',\n    clients: ['7c830e38-9903-44e6-98f7-7f79941b16ff']\n  },\n  {\n    id: 'b9e22955-89ce-43e6-87f6-4de131436a22',\n    name: 'Demo',\n    cvrno: '',\n    type: 'opdragsgiver',\n    clients: ['7c830e38-9903-44e6-98f7-7f79941b16ff']\n  },\n  {\n    id: '2e8df1dd-458d-4c8e-8498-7f79931b15ff',\n    name: 'MTH',\n    cvrno: '',\n    type: 'opdragsgiver',\n    clients: ['7c830e38-9903-44e6-98f7-7f79941b16ff']\n  },\n  {\n    id: 'd78ae731-0026-46fd-be2b-c05e6663cfe5',\n    name: 'Bravida',\n    cvrno: '',\n    type: 'opdragsgiver',\n    clients: ['7c830e38-9903-44e6-98f7-7f79941b16ff']\n  },\n  {\n    id: '020c4051-b910-438c-a50b-8a3fe1898fda',\n    name: 'Nordkysten',\n    cvrno: '',\n    type: 'opdragsgiver',\n    clients: ['7c830e38-9903-44e6-98f7-7f79941b16ff']\n  },\n  {\n    id: '7c730e38-9903-44e6-98f7-9c32c87c9c03',\n    name: 'Munck',\n    cvrno: '',\n    type: 'opdragsgiver',\n    clients: ['7c830e38-9903-44e6-98f7-7f79941b16ff']\n  }\n]\n\nmodule.exports = clients.map(client => {\n  return {\n    id: client.id,\n    data: {\n      name: client.name,\n      cvrno: client.cvrno,\n      type: client.type,\n      clients: client.clients\n    }\n  }\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/seed/clients.js"],"sourceRoot":""}